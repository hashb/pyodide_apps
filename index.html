<!doctype html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <title>Stlite App</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@stlite/browser@0.83.0/build/style.css" />
</head>

<body>
    <div id="root"></div>
    <!-- <script type="module" src="https://cdn.jsdelivr.net/npm/@stlite/browser@0.83.0/build/stlite.js"></script> -->
    <script type="module">
        import { mount } from "https://cdn.jsdelivr.net/npm/@stlite/browser@0.83.0/build/stlite.js";
        function init() {
            console.log("init");
            const baseUrl = `${window.location.protocol}//${window.location.host}`;
            fetch(`${baseUrl}/app.py`).then(res => res.text()).then(
                (app) => mount(
                    {
                        requirements: [
                            "matplotlib",
                            `${baseUrl}/vendor/pychm-0.8.6+pyodide-cp312-cp312-pyodide_2024_0_wasm32.whl`,
                            `${baseUrl}/vendor/sgmllib3k-1.0.0-py3-none-any.whl`,
                            `${baseUrl}/vendor/archmage-0.4.2.1-py3-none-any.whl`,
                        ],
                        entrypoint: "app.py", // The target file of the `streamlit run` command
                        files: {
                            "app.py": app,
                        },
                        streamlitConfig: {
                            // Streamlit configuration
                            "client.toolbarMode": "viewer",
                        },
                    },
                    document.getElementById("root"),
                )
            );
        }
        init();
    </script>
</body>

</html>